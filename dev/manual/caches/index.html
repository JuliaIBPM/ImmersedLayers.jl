<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Immersed layer caches · ImmersedLayers.jl</title><meta name="title" content="Immersed layer caches · ImmersedLayers.jl"/><meta property="og:title" content="Immersed layer caches · ImmersedLayers.jl"/><meta property="twitter:title" content="Immersed layer caches · ImmersedLayers.jl"/><meta name="description" content="Documentation for ImmersedLayers.jl."/><meta property="og:description" content="Documentation for ImmersedLayers.jl."/><meta property="twitter:description" content="Documentation for ImmersedLayers.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ImmersedLayers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Basics</span><ul><li class="is-active"><a class="tocitem" href>Immersed layer caches</a><ul class="internal"><li><a class="tocitem" href="#Setting-up-a-cache"><span>Setting up a cache</span></a></li><li><a class="tocitem" href="#Plotting-the-immersed-points"><span>Plotting the immersed points</span></a></li><li><a class="tocitem" href="#Some-basic-utilities"><span>Some basic utilities</span></a></li><li><a class="tocitem" href="#Using-norms,-inner-products,-and-integrals"><span>Using norms, inner products, and integrals</span></a></li><li><a class="tocitem" href="#Cache-types-and-constructors"><span>Cache types and constructors</span></a></li><li><a class="tocitem" href="#Utilities-for-creating-instances-of-data"><span>Utilities for creating instances of data</span></a></li><li><a class="tocitem" href="#Utilities-for-accessing-surface-information"><span>Utilities for accessing surface information</span></a></li><li><a class="tocitem" href="#Inner-products,-norms,-and-integrals"><span>Inner products, norms, and integrals</span></a></li><li><a class="tocitem" href="#Other-cache-utilities"><span>Other cache utilities</span></a></li></ul></li><li><a class="tocitem" href="../surfaceops/">Surface-grid operations</a></li><li><a class="tocitem" href="../multbodies/">Multiple bodies</a></li><li><a class="tocitem" href="../gridops/">Grid operations</a></li><li><a class="tocitem" href="../helmholtz/">Helmholtz decomposition</a></li><li><a class="tocitem" href="../matrices/">Matrix operators</a></li><li><a class="tocitem" href="../dirichlet/">A Dirichlet Poisson problem</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li></ul></li><li><span class="tocitem">Setting up PDEs</span><ul><li><a class="tocitem" href="../problems/">Problems and the system</a></li><li><a class="tocitem" href="../neumann/">Poisson with Neumann conditions</a></li><li><a class="tocitem" href="../stokes/">Stokes flow</a></li><li><a class="tocitem" href="../heatconduction/">Setting up a time-varying PDE</a></li><li><a class="tocitem" href="../heatconduction-unbounded/">A time-varying PDE with forcing</a></li><li><a class="tocitem" href="../heatconduction-neumann/">A time-varying PDE with Neumann conditions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Immersed layer caches</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Immersed layer caches</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ImmersedLayers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/main/test/literate/caches.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Immersed-layer-caches"><a class="docs-heading-anchor" href="#Immersed-layer-caches">Immersed layer caches</a><a id="Immersed-layer-caches-1"></a><a class="docs-heading-anchor-permalink" href="#Immersed-layer-caches" title="Permalink"></a></h1><p>This package uses precomputed caches to efficiently implement the immersed layer operators. The starting point for a cache is the specification of the (discretized) body shape and the grid. Let&#39;s use an example.</p><h2 id="Setting-up-a-cache"><a class="docs-heading-anchor" href="#Setting-up-a-cache">Setting up a cache</a><a id="Setting-up-a-cache-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-a-cache" title="Permalink"></a></h2><pre><code class="language-julia hljs">using ImmersedLayers
using Plots
using LinearAlgebra</code></pre><h3 id="Set-up-a-grid"><a class="docs-heading-anchor" href="#Set-up-a-grid">Set up a grid</a><a id="Set-up-a-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-a-grid" title="Permalink"></a></h3><p>First, we will set up a grid for performing the operations. We use the <code>PhysicalGrid</code> constructor of the <code>CartesianGrids.jl</code> package to create this.</p><pre><code class="language-julia hljs">Δx = 0.01
Lx = 4.0
xlim = (-Lx/2,Lx/2)
ylim = (-Lx/2,Lx/2)
g = PhysicalGrid(xlim,ylim,Δx)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PhysicalGrid{2}((408, 408), (204, 204), 0.01, ((-2.0300000000000002, 2.0300000000000002), (-2.0300000000000002, 2.0300000000000002)), 2)</code></pre><h3 id="Set-the-shape"><a class="docs-heading-anchor" href="#Set-the-shape">Set the shape</a><a id="Set-the-shape-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-shape" title="Permalink"></a></h3><p>Now let&#39;s set a shape to immerse into the grid. We will use a circle, but there are a variety of other shapes available. Many of these are in the <code>RigidBodyTools.jl</code> package. Note that we set the spacing between the points on this shape equal to 1.4 times the grid spacing. This is not critical, but it is generally best to set it to a value between 1 and 2.</p><pre><code class="language-julia hljs">RadC = 1.0
Δs = 1.4*cellsize(g)
body = Circle(RadC,Δs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Circular body with 448 points and radius 1.0
   Current position: (0.0,0.0)
   Current angle (rad): 0.0
</code></pre><h3 id="Create-the-cache"><a class="docs-heading-anchor" href="#Create-the-cache">Create the cache</a><a id="Create-the-cache-1"></a><a class="docs-heading-anchor-permalink" href="#Create-the-cache" title="Permalink"></a></h3><p>After setting the grid and the surface to immerse, the next step for using the immersed layer tools is to set up a <em>surface cache</em>. This allocates a set of data structures, as well as the critical <em>regularization</em> and <em>interpolation</em> operators that will get used.</p><p>There are a few choices to make when setting this up</p><ul><li><strong>What kind of data (scalar or vector) are we dealing with?</strong></li></ul><p>We will demonstrate with scalar data, which means we use the <a href="#ImmersedLayers.SurfaceScalarCache"><code>SurfaceScalarCache</code></a> function. For vector data, use <a href="#ImmersedLayers.SurfaceVectorCache"><code>SurfaceVectorCache</code></a>.</p><ul><li><strong>What type of scaling (grid or index) do we wish to apply to the operators?</strong></li></ul><p>Grid scaling, set with <code>scaling = GridScaling</code>, means that the various operators are scaled with the physical grid spacing and/or surface point spacing so that they approximate the continuous operators. This means that regularization and interpolation are transposes with respect to inner products that incorporate these physical spacings, rather than the usual linear algebra inner products. Also, differential operations on the grid are true approximations of their continuous counterparts. This choice of scaling is usually the best, and the <a href="#LinearAlgebra.dot-Tuple{GridData, GridData, BasicILMCache}"><code>dot</code></a> operator is extended in this package to implement the physically- scaled inner products.</p><p>On the other hand, <code>scaling = IndexScaling</code> does not scale these, but rather, uses pure differencing for the grid differential operators, and regularization is the simple matrix transpose of interpolation.</p><ul><li><strong>What discrete Dirac delta function (DDF) do we wish to use?</strong></li></ul><p>This is specified with the <code>ddftype</code> keyword argument. The default is <code>ddftype=CartesianGrids.Yang3</code> <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. However, there are other choices, such as <code>CartesianGrids.Roma</code>, <code>CartesianGrids.Goza</code>, <code>CartesianGrids.Witchhat</code>, <code>CartesianGrids.M3</code>, <code>CartesianGrids.M4prime</code>.</p><pre><code class="language-julia hljs">cache = SurfaceScalarCache(body,g,scaling=GridScaling)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Surface cache with scaling of type GridScaling
  448 point data of type ScalarData{448, Float64, Vector{Float64}}
  Grid data of type Nodes{Primal, 408, 408, Float64, Matrix{Float64}}
</code></pre><h2 id="Plotting-the-immersed-points"><a class="docs-heading-anchor" href="#Plotting-the-immersed-points">Plotting the immersed points</a><a id="Plotting-the-immersed-points-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-immersed-points" title="Permalink"></a></h2><p>We can plot the immersed points with the <code>plot</code> function of the <code>Plots.jl</code> package, using a special plot recipe. This accepts all of the usual attribute keywords of the basic plot function.</p><pre><code class="language-julia hljs">plot(cache,xlims=(-2,2),ylims=(-2,2))</code></pre><img src="a0b98795.svg" alt="Example block output"/><p>In this plotting demonstration, we have used the <code>points</code> function to obtain the coordinates of the immersed points. Other useful utilities are <code>normals</code>, <code>areas</code>, and <code>arcs</code>, e.g.</p><pre><code class="language-julia hljs">normals(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">448 points of vector-valued Float64 data
896-element Vector{Float64}:
  0.9999999999988712
  0.9999016728287639
  0.9996065842578712
  0.999115045044428
  0.9984267309011199
  0.9975423661130551
  0.9964613682740765
  0.9951848732366676
  0.9937120427187925
  0.992044421068211
  ⋮
 -0.12589126758565716
 -0.11196299239880425
 -0.09801862843388753
 -0.08404903300348561
 -0.07006887224977693
 -0.05606894942065292
 -0.04206398840993138
 -0.02804475491729984
 -0.014026009668317694</code></pre><h2 id="Some-basic-utilities"><a class="docs-heading-anchor" href="#Some-basic-utilities">Some basic utilities</a><a id="Some-basic-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Some-basic-utilities" title="Permalink"></a></h2><p>We will see deeper uses of this cache in <a href="../surfaceops/#Surface-grid-operations">Surface-grid operations</a>. However, for now we can learn how to get basic copies of the grid and surface data. For example, a copy of the grid data, all initialized to zero:</p><pre><code class="language-julia hljs">zeros_grid(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Nodes{Primal, 408, 408, Float64, Matrix{Float64}} data
Printing in grid orientation (lower left is (1,1))
407×407 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱  ⋮                        ⋮    
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>or similarly on the surface</p><pre><code class="language-julia hljs">zeros_surface(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">448 points of scalar-valued Float64 data
448-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code></pre><p>We also might need to initialize data on the grid to accept the curl of a vector field. This is used in conjunction with <a href="../surfaceops/#ImmersedLayers.surface_curl!"><code>surface_curl!</code></a>, for example.</p><pre><code class="language-julia hljs">zeros_gridcurl(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Nodes{Dual, 408, 408, Float64, Matrix{Float64}} data
Printing in grid orientation (lower left is (1,1))
408×408 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱                      ⋮         
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>If we want them initialized to unity, then use</p><pre><code class="language-julia hljs">ones_grid(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Nodes{Primal, 408, 408, Float64, Matrix{Float64}} data
Printing in grid orientation (lower left is (1,1))
407×407 Matrix{Float64}:
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 ⋮                        ⋮              ⋱  ⋮                        ⋮    
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  …  1.0  1.0  1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0     1.0  1.0  1.0  1.0  1.0  1.0  1.0</code></pre><p>and</p><pre><code class="language-julia hljs">ones_surface(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">448 points of scalar-valued Float64 data
448-element Vector{Float64}:
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 ⋮
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0
 1.0</code></pre><p>To evaluate functions on the grid, it is useful to be able to fill grid data with the x and y coordinates. For this, we use</p><pre><code class="language-julia hljs">x_grid(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Nodes{Primal, 408, 408, Float64, Matrix{Float64}} data
Printing in grid orientation (lower left is (1,1))
407×407 Matrix{Float64}:
 -2.03  -2.02  -2.01  -2.0  -1.99  …  1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99  …  1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
  ⋮                                ⋱                         ⋮     
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99  …  1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99  …  1.98  1.99  2.0  2.01  2.02  2.03
 -2.03  -2.02  -2.01  -2.0  -1.99     1.98  1.99  2.0  2.01  2.02  2.03</code></pre><pre><code class="language-julia hljs">y_grid(cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Nodes{Primal, 408, 408, Float64, Matrix{Float64}} data
Printing in grid orientation (lower left is (1,1))
407×407 Matrix{Float64}:
  2.03   2.03   2.03   2.03   2.03  …   2.03   2.03   2.03   2.03   2.03
  2.02   2.02   2.02   2.02   2.02      2.02   2.02   2.02   2.02   2.02
  2.01   2.01   2.01   2.01   2.01      2.01   2.01   2.01   2.01   2.01
  2.0    2.0    2.0    2.0    2.0       2.0    2.0    2.0    2.0    2.0
  1.99   1.99   1.99   1.99   1.99      1.99   1.99   1.99   1.99   1.99
  1.98   1.98   1.98   1.98   1.98  …   1.98   1.98   1.98   1.98   1.98
  1.97   1.97   1.97   1.97   1.97      1.97   1.97   1.97   1.97   1.97
  1.96   1.96   1.96   1.96   1.96      1.96   1.96   1.96   1.96   1.96
  1.95   1.95   1.95   1.95   1.95      1.95   1.95   1.95   1.95   1.95
  1.94   1.94   1.94   1.94   1.94      1.94   1.94   1.94   1.94   1.94
  ⋮                                 ⋱                        ⋮     
 -1.95  -1.95  -1.95  -1.95  -1.95     -1.95  -1.95  -1.95  -1.95  -1.95
 -1.96  -1.96  -1.96  -1.96  -1.96     -1.96  -1.96  -1.96  -1.96  -1.96
 -1.97  -1.97  -1.97  -1.97  -1.97  …  -1.97  -1.97  -1.97  -1.97  -1.97
 -1.98  -1.98  -1.98  -1.98  -1.98     -1.98  -1.98  -1.98  -1.98  -1.98
 -1.99  -1.99  -1.99  -1.99  -1.99     -1.99  -1.99  -1.99  -1.99  -1.99
 -2.0   -2.0   -2.0   -2.0   -2.0      -2.0   -2.0   -2.0   -2.0   -2.0
 -2.01  -2.01  -2.01  -2.01  -2.01     -2.01  -2.01  -2.01  -2.01  -2.01
 -2.02  -2.02  -2.02  -2.02  -2.02  …  -2.02  -2.02  -2.02  -2.02  -2.02
 -2.03  -2.03  -2.03  -2.03  -2.03     -2.03  -2.03  -2.03  -2.03  -2.03</code></pre><h2 id="Using-norms,-inner-products,-and-integrals"><a class="docs-heading-anchor" href="#Using-norms,-inner-products,-and-integrals">Using norms, inner products, and integrals</a><a id="Using-norms,-inner-products,-and-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Using-norms,-inner-products,-and-integrals" title="Permalink"></a></h2><p>It is useful to compute norms and inner products on grid or surface data. These tools are easily accessible and intuitive, e.g., <code>dot(u,v,cache)</code> and <code>norm(u,cache)</code>, and they respect the scaling associated with the cache. For example, the following gives an approximation of the circumference of the circle:</p><pre><code class="language-julia hljs">os = ones_surface(cache)
dot(os,os,cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.283288300933757</code></pre><p>We can also numerically integrate on surfaces or grids. For example, the previous example could have been written</p><pre><code class="language-julia hljs">integrate(os,cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.283288300933757</code></pre><p>Or, to compute an area integral over the whole domain,</p><pre><code class="language-julia hljs">og = ones_grid(cache)
integrate(og,cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16.483600000000003</code></pre><p>If the underlying data are of vector or tensor form, then the <code>integrate</code> function operates on every component</p><pre><code class="language-julia hljs">ovg = ones_gridgrad(cache)
integrate(ovg,cache)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 16.483600000000003
 16.483600000000003</code></pre><h2 id="Cache-types-and-constructors"><a class="docs-heading-anchor" href="#Cache-types-and-constructors">Cache types and constructors</a><a id="Cache-types-and-constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Cache-types-and-constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.BasicILMCache" href="#ImmersedLayers.BasicILMCache"><code>ImmersedLayers.BasicILMCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct BasicILMCache{N, SCA&lt;:AbstractScalingType, GCT, ND, BLT&lt;:BodyList, NT&lt;:VectorData, DST&lt;:ScalarData, REGT&lt;:Regularize, RSNT&lt;:RegularizationMatrix, ESNT&lt;:InterpolationMatrix, RT&lt;:RegularizationMatrix, ET&lt;:InterpolationMatrix, RCT, ECT, RDT, EDT, LT&lt;:Laplacian, GVT, GNT, GDT, SVT, SDT, SST} &lt;: ImmersedLayers.AbstractBasicCache{N, GCT}</code></pre><p>A cache of operators and storage data for use in surface operations. Constructed with <a href="#ImmersedLayers.SurfaceScalarCache"><code>SurfaceScalarCache</code></a> or <a href="#ImmersedLayers.SurfaceVectorCache"><code>SurfaceVectorCache</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.SurfaceScalarCache" href="#ImmersedLayers.SurfaceScalarCache"><code>ImmersedLayers.SurfaceScalarCache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SurfaceScalarCache(g::PhysicalGrid[,scaling=IndexScaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code> with scalar grid data, using the grid specified in <code>g</code>, with no immersed points. The keyword <code>scaling</code> can be used to set the scaling in the operations. By default, it is set to <code>IndexScaling</code> which sets the differential operators to be only differencing operators. By using <code>scaling = GridScaling</code>, then the grid and  spacings are accounted for and differential operators are scaled by this spacing.  The keyword <code>phys_params</code> can be used to supply physical parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L103-L113">source</a></section><section><div><pre><code class="language-julia hljs">SurfaceScalarCache(body::Body/BodyList,g::PhysicalGrid[,ddftype=CartesianGrids.Yang3][,scaling=GridScaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code>, holding operators and storage data for use in immersed layer operations on scalar data. This is sometimes called from within<code>ILMSystem</code> rather than directly.</p><p>The <code>body</code> can be of type <code>Body</code> or <code>BodyList</code>. The keyword <code>scaling</code> can be used to set the scaling in the operations. By default, it is set to <code>IndexScaling</code> which sets the regularization and interpolation to be symmetric matrices (i.e., interpolation is the adjoint of regularization with   respect to a vector dot product), and the vector calculus operations on the grid   are simple differences. By using <code>scaling = GridScaling</code>, then the grid and   point spacings are accounted for. Interpolation and regularization are adjoints   with respect to inner products based on discretized surface and volume integrals,   and vector calculus operations are scaled by the grid spacing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L130-L144">source</a></section><section><div><pre><code class="language-julia hljs">SurfaceScalarCache(X::VectorData,g::PhysicalGrid[,ddftype=CartesianGrids.Yang3][,scaling=GridScaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code>, holding operators and storage data for use in immersed layer operations on scalar data. The <code>X</code> specifies the is assumed to hold the endpoints of the immersed surface segments, and <code>g</code> the physical grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L146-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.SurfaceVectorCache" href="#ImmersedLayers.SurfaceVectorCache"><code>ImmersedLayers.SurfaceVectorCache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SurfaceVectorCache(g::PhysicalGrid[,scaling=IndexScaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code> with vector grid data, with no immersed points. See <a href="#ImmersedLayers.SurfaceScalarCache"><code>SurfaceScalarCache</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L115-L120">source</a></section><section><div><pre><code class="language-julia hljs">SurfaceVectorCache(body::Body/BodyList,g::PhysicalGrid[,ddftype=CartesianGrids.Yang3][,scaling=Gridcaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code>, holding operators and storage data for use in immersed layer operations on vector data. See <a href="#ImmersedLayers.SurfaceScalarCache"><code>SurfaceScalarCache</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L122-L128">source</a></section><section><div><pre><code class="language-julia hljs">SurfaceVectorCache(X::VectorData,g::PhysicalGrid[,ddftype=CartesianGrids.Yang3][,scaling=GridScaling])</code></pre><p>Create a cache of type <code>BasicILMCache</code>, holding operators and storage data for use in immersed layer operations on vector data. See <a href="#ImmersedLayers.SurfaceScalarCache"><code>SurfaceScalarCache</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L154-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.AbstractExtraILMCache" href="#ImmersedLayers.AbstractExtraILMCache"><code>ImmersedLayers.AbstractExtraILMCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractExtraILMCache</code></pre><p>When defining problem-specific cache, make it a subtype of this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L2">source</a></section></article><h2 id="Utilities-for-creating-instances-of-data"><a class="docs-heading-anchor" href="#Utilities-for-creating-instances-of-data">Utilities for creating instances of data</a><a id="Utilities-for-creating-instances-of-data-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-for-creating-instances-of-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_grid" href="#ImmersedLayers.similar_grid"><code>ImmersedLayers.similar_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_grid(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the basic grid data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L394-L398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_gridgrad" href="#ImmersedLayers.similar_gridgrad"><code>ImmersedLayers.similar_gridgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_gridgrad(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the gradient of the grid data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L401-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_gridcurl" href="#ImmersedLayers.similar_gridcurl"><code>ImmersedLayers.similar_gridcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_gridcurl(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the grid curl field data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L409-L413">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_griddiv" href="#ImmersedLayers.similar_griddiv"><code>ImmersedLayers.similar_griddiv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_griddiv(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the grid div field data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L416-L420">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_gridgradcurl" href="#ImmersedLayers.similar_gridgradcurl"><code>ImmersedLayers.similar_gridgradcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_gridgradcurl(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the grid gradient-of-curl field data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L424-L428">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_surface" href="#ImmersedLayers.similar_surface"><code>ImmersedLayers.similar_surface</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_surface(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the basic surface point data in the cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L432-L436">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.similar_surfacescalar" href="#ImmersedLayers.similar_surfacescalar"><code>ImmersedLayers.similar_surfacescalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similar_surfacescalar(::BasicILMCache)</code></pre><p>Get a <code>similar</code> copy of the surface scalar point data in the cache. This is only used for vector-type caches. Otherwise, <a href="#ImmersedLayers.similar_surface"><code>similar_surface</code></a> should be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L439-L445">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_grid" href="#ImmersedLayers.zeros_grid"><code>ImmersedLayers.zeros_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_grid(::BasicILMCache)</code></pre><p>Get an instance of the basic grid data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L452-L456">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_gridgrad" href="#ImmersedLayers.zeros_gridgrad"><code>ImmersedLayers.zeros_gridgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_gridgrad(::BasicILMCache)</code></pre><p>Get an instance of the gradient of the grid data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L459-L463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_gridcurl" href="#ImmersedLayers.zeros_gridcurl"><code>ImmersedLayers.zeros_gridcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_gridcurl(::BasicILMCache)</code></pre><p>Get an instance of the grid curl field data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L467-L471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_griddiv" href="#ImmersedLayers.zeros_griddiv"><code>ImmersedLayers.zeros_griddiv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_griddiv(::BasicILMCache)</code></pre><p>Get an instance of the grid div field data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L474-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_gridgradcurl" href="#ImmersedLayers.zeros_gridgradcurl"><code>ImmersedLayers.zeros_gridgradcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_gridgradcurl(::BasicILMCache)</code></pre><p>Get an instance of the grid gradient-of-curl field data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L481-L485">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_surface" href="#ImmersedLayers.zeros_surface"><code>ImmersedLayers.zeros_surface</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_surface(::BasicILMCache)</code></pre><p>Get an instance of the basic surface point data in the cache, with values set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L489-L493">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.zeros_surfacescalar" href="#ImmersedLayers.zeros_surfacescalar"><code>ImmersedLayers.zeros_surfacescalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zeros_surfacescalar(::BasicILMCache)</code></pre><p>Get an instance of the surface scalar point data in the cache, with values set to zero. This is only used for vector-type caches. Otherwise, <a href="#ImmersedLayers.zeros_surface"><code>zeros_surface</code></a> should be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L496-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_grid" href="#ImmersedLayers.ones_grid"><code>ImmersedLayers.ones_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_grid(::BasicILMCache)</code></pre><p>Get an instance of the basic grid data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L509-L513">source</a></section><section><div><pre><code class="language-julia hljs">ones_grid(::BasicILMCache,dim)</code></pre><p>For a vector-type cache, get an instance of the basic grid data in the cache, with values set to unity in dimension <code>dim</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L516-L521">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_gridgrad" href="#ImmersedLayers.ones_gridgrad"><code>ImmersedLayers.ones_gridgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_gridgrad(::BasicILMCache)</code></pre><p>Get an instance of the gradient of the grid data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L525-L530">source</a></section><section><div><pre><code class="language-julia hljs">ones_gridgrad(::BasicILMCache,dim)</code></pre><p>Get an instance of the gradient of the grid data in the cache, in direction <code>dim</code>, with values set to unity. If the data are of type <code>TensorGridData</code>, then <code>dim</code> takes values from 1 to 2^2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L534-L540">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_gridcurl" href="#ImmersedLayers.ones_gridcurl"><code>ImmersedLayers.ones_gridcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_gridcurl(::BasicILMCache)</code></pre><p>Get an instance of the grid curl field data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L544-L548">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_griddiv" href="#ImmersedLayers.ones_griddiv"><code>ImmersedLayers.ones_griddiv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_griddiv(::BasicILMCache)</code></pre><p>Get an instance of the grid div field data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L551-L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_gridgradcurl" href="#ImmersedLayers.ones_gridgradcurl"><code>ImmersedLayers.ones_gridgradcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_gridgradcurl(::BasicILMCache)</code></pre><p>Get an instance of the grid gradient-of-curl field data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L559-L563">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_surface" href="#ImmersedLayers.ones_surface"><code>ImmersedLayers.ones_surface</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_surface(::BasicILMCache)</code></pre><p>Get an instance of the basic surface point data in the cache, with values set to unity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L568-L572">source</a></section><section><div><pre><code class="language-julia hljs">ones_surface(::BasicILMCache,dim)</code></pre><p>Get an instance of the basic surface point data in the cache, with values set to unity in dimension <code>dim</code>. This only works for a vector-type cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L575-L580">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ones_surfacescalar" href="#ImmersedLayers.ones_surfacescalar"><code>ImmersedLayers.ones_surfacescalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ones_surfacescalar(::BasicILMCache)</code></pre><p>Get an instance of the surface scalar point data in the cache, with values set to unity. This is only used for vector-type caches. Otherwise, <a href="#ImmersedLayers.ones_surface"><code>ones_surface</code></a> should be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L584-L590">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.x_grid" href="#ImmersedLayers.x_grid"><code>ImmersedLayers.x_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">x_grid(::BasicILMCache)</code></pre><p>Return basic grid data filled with the grid <code>x</code> coordinate. If the grid data is scalar, then the output of this function is of the same type. If the grid data is vector, then the output is of type <code>Edges{Primal}</code>, and the coordinates of each component are in <code>u</code>, <code>v</code> fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L598-L606">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.y_grid" href="#ImmersedLayers.y_grid"><code>ImmersedLayers.y_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">y_grid(::BasicILMCache)</code></pre><p>Return basic grid data filled with the grid <code>y</code> coordinate. If the grid data is scalar, then the output of this function is of the same type. If the grid data is vector, then the output is of type <code>Edges{Primal}</code>, and the coordinates of each component are in <code>u</code>, <code>v</code> fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L693-L701">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.x_gridcurl" href="#ImmersedLayers.x_gridcurl"><code>ImmersedLayers.x_gridcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">x_gridcurl(::BasicILMCache)</code></pre><p>Return basic grid curl field data filled with the grid <code>x</code> coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L637-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.y_gridcurl" href="#ImmersedLayers.y_gridcurl"><code>ImmersedLayers.y_gridcurl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">y_gridcurl(::BasicILMCache)</code></pre><p>Return basic grid curl field data filled with the grid <code>y</code> coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L721-L725">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.x_griddiv" href="#ImmersedLayers.x_griddiv"><code>ImmersedLayers.x_griddiv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">x_griddiv(::BasicILMCache)</code></pre><p>Return basic grid div field data filled with the grid <code>x</code> coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L648-L652">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.y_griddiv" href="#ImmersedLayers.y_griddiv"><code>ImmersedLayers.y_griddiv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">y_griddiv(::BasicILMCache)</code></pre><p>Return basic grid div field data filled with the grid <code>y</code> coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L732-L736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.x_gridgrad" href="#ImmersedLayers.x_gridgrad"><code>ImmersedLayers.x_gridgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">x_gridgrad(::BasicILMCache)</code></pre><p>Return basic grid gradient field data filled with the grid <code>x</code> coordinate. If the grid data is scalar, then the output of this function is of <code>Edges{Primal}</code> type and the coordinate field for each component can be accessed with the <code>u</code> and <code>v</code> field, respectively. If the grid data is vector, then the output is of type <code>EdgeGradient{Primal}</code>, and the coordinates are in <code>dudx</code>, <code>dudy</code>, <code>dvdx</code>, and <code>dvdy</code> fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L663-L672">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.y_gridgrad" href="#ImmersedLayers.y_gridgrad"><code>ImmersedLayers.y_gridgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">y_gridgrad(::BasicILMCache)</code></pre><p>Return basic grid gradient field data filled with the grid <code>y</code> coordinate. If the grid data is scalar, then the output of this function is of <code>Edges{Primal}</code> type and the coordinate field for each component can be accessed with the <code>u</code> and <code>v</code> field, respectively. If the grid data is vector, then the output is of type <code>EdgeGradient{Primal}</code>, and the coordinates are in <code>dudx</code>, <code>dudy</code>, <code>dvdx</code>, and <code>dvdy</code> fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L747-L756">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.evaluate_field!" href="#ImmersedLayers.evaluate_field!"><code>ImmersedLayers.evaluate_field!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_field!(f::GridData,s::AbstractSpatialField,cache)</code></pre><p>Evaluate a spatial field <code>s</code> in place as grid data <code>f</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/fields.jl#L3-L7">source</a></section><section><div><pre><code class="language-julia hljs">evaluate_field!(f::GridData,t,s::AbstractSpatialField,cache)</code></pre><p>Evaluate a spatial-temporal field <code>s</code> at time <code>t</code> in place as grid data <code>f</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/fields.jl#L15-L19">source</a></section></article><h2 id="Utilities-for-accessing-surface-information"><a class="docs-heading-anchor" href="#Utilities-for-accessing-surface-information">Utilities for accessing surface information</a><a id="Utilities-for-accessing-surface-information-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-for-accessing-surface-information" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.areas-Tuple{BasicILMCache}" href="#ImmersedLayers.areas-Tuple{BasicILMCache}"><code>ImmersedLayers.areas</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">areas(cache::BasicILMCache)</code></pre><p>Return the areas (as <code>ScalarData</code>) of the surface panels associated with <code>cache</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L800-L804">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.normals-Tuple{BasicILMCache}" href="#ImmersedLayers.normals-Tuple{BasicILMCache}"><code>ImmersedLayers.normals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">normals(cache::BasicILMCache)</code></pre><p>Return the normals (as <code>VectorData</code>) of the surface points associated with <code>cache</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L793-L797">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.points-Tuple{BasicILMCache}" href="#ImmersedLayers.points-Tuple{BasicILMCache}"><code>ImmersedLayers.points</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">points(cache::BasicILMCache)</code></pre><p>Return the coordinates (as <code>VectorData</code>) of the surface points associated with <code>cache</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L779-L783">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.arcs-Tuple{BasicILMCache}" href="#ImmersedLayers.arcs-Tuple{BasicILMCache}"><code>ImmersedLayers.arcs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">arcs(cache::BasicILMCache)</code></pre><p>Return <code>ScalarData</code> of arc length coordinates for the body surface(s) in the given cache <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L939-L944">source</a></section></article><h2 id="Inner-products,-norms,-and-integrals"><a class="docs-heading-anchor" href="#Inner-products,-norms,-and-integrals">Inner products, norms, and integrals</a><a id="Inner-products,-norms,-and-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Inner-products,-norms,-and-integrals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.dot-Tuple{GridData, GridData, BasicILMCache}" href="#LinearAlgebra.dot-Tuple{GridData, GridData, BasicILMCache}"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dot(u1::GridData,u2::GridData,cache::BasicILMCache)</code></pre><p>Calculate the inner product of grid data <code>u1</code> and <code>u2</code>, using the scaling associated with <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L819-L823">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.dot-Tuple{PointData, PointData, BasicILMCache}" href="#LinearAlgebra.dot-Tuple{PointData, PointData, BasicILMCache}"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dot(u1::PointData,u2::PointData,cache::BasicILMCache)</code></pre><p>Calculate the inner product of surface point data <code>u1</code> and <code>u2</code>, using the scaling associated with <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L856-L860">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.norm-Tuple{GridData, BasicILMCache}" href="#LinearAlgebra.norm-Tuple{GridData, BasicILMCache}"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">norm(u::GridData,cache::BasicILMCache)</code></pre><p>Calculate the norm of grid data <code>u</code>, using the scaling associated with <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L809-L813">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.integrate-Tuple{GridData, BasicILMCache}" href="#CartesianGrids.integrate-Tuple{GridData, BasicILMCache}"><code>CartesianGrids.integrate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">integrate(u::GridData,cache::BasicILMCache)</code></pre><p>Calculate the discrete volume integral of grid data <code>u</code>. If <code>u</code> is <code>VectorGridData</code>, then this returns a vector of the integrals in each coordinate direction. This integral produces the same result regardless if <code>GridScaling</code> or <code>IndexScaling</code> is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L875-L882">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.norm-Tuple{PointData, BasicILMCache}" href="#LinearAlgebra.norm-Tuple{PointData, BasicILMCache}"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">norm(u::PointData,cache::BasicILMCache)</code></pre><p>Calculate the norm of surface point data <code>u</code>, using the scaling associated with <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L829-L833">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.integrate-Union{Tuple{N}, Tuple{PointData{N}, BasicILMCache{N}}} where N" href="#CartesianGrids.integrate-Union{Tuple{N}, Tuple{PointData{N}, BasicILMCache{N}}} where N"><code>CartesianGrids.integrate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">integrate(u::PointData,cache::BasicILMCache)</code></pre><p>Calculate the discrete surface integral of data <code>u</code> on the immersed points in <code>cache</code>. This uses trapezoidal rule quadrature. If <code>u</code> is <code>VectorData</code>, then this returns a vector of the integrals in each coordinate direction. This operation produces the same effect, regardless if <code>cache</code> is set up for <code>GridScaling</code> or <code>IndexScaling</code>. In both cases, the surface element areas are used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L887-L895">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.dot-Tuple{PointData, PointData, BasicILMCache, Int64}" href="#LinearAlgebra.dot-Tuple{PointData, PointData, BasicILMCache, Int64}"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dot(u1::PointData,u2::PointData,cache::BasicILMCache,i)</code></pre><p>Calculate the inner product of surface point data <code>u1</code> and <code>u2</code> for body <code>i</code> in the cache <code>cache</code>, scaling as appropriate for this cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L862-L867">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.norm-Tuple{PointData, BasicILMCache, Int64}" href="#LinearAlgebra.norm-Tuple{PointData, BasicILMCache, Int64}"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">norm(u::PointData,cache::BasicILMCache,i::Int)</code></pre><p>Calculate the norm of surface point data <code>u</code>, using the scaling associated with <code>cache</code>, for body <code>i</code> in the body list of <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L839-L844">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.integrate-Union{Tuple{N}, Tuple{PointData{N}, BasicILMCache{N}, Int64}} where N" href="#CartesianGrids.integrate-Union{Tuple{N}, Tuple{PointData{N}, BasicILMCache{N}, Int64}} where N"><code>CartesianGrids.integrate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">integrate(u::PointData,cache::BasicILMCache,i::Int)</code></pre><p>Calculate the discrete surface integral of scalar data <code>u</code> on the immersed points in <code>cache</code>, on body <code>i</code> in the body list in <code>cache</code>. This uses trapezoidal rule quadrature. If <code>u</code> is <code>VectorData</code>, then this returns a vector of the integrals in each coordinate direction. This operation produces the same effect, regardless if <code>cache</code> is set up for <code>GridScaling</code> or <code>IndexScaling</code>. In both cases, the surface element areas are used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L899-L908">source</a></section></article><h2 id="Other-cache-utilities"><a class="docs-heading-anchor" href="#Other-cache-utilities">Other cache utilities</a><a id="Other-cache-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Other-cache-utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.view-Tuple{PointData, BasicILMCache, Int64}" href="#Base.view-Tuple{PointData, BasicILMCache, Int64}"><code>Base.view</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">view(u::PointData,cache::BasicILMCache,i::Int)</code></pre><p>Provide a <code>view</code> of point data <code>u</code> corresponding to body <code>i</code> in the list of bodies in <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L913-L918">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.copyto!-Tuple{PointData, PointData, BasicILMCache, Int64}" href="#Base.copyto!-Tuple{PointData, PointData, BasicILMCache, Int64}"><code>Base.copyto!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copyto!(u::PointData,v::PointData,cache::BasicILMCache,i::Int)</code></pre><p>Copy the data in the elements of <code>v</code> associated with body <code>i</code> in the body list in <code>cache</code> to the corresponding elements in <code>u</code>. These data must be of the same type (e.g., <code>ScalarData</code> or <code>VectorData</code>) and have the same length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L921-L927">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.copyto!-Tuple{ScalarData, AbstractVector, BasicILMCache, Int64}" href="#Base.copyto!-Tuple{ScalarData, AbstractVector, BasicILMCache, Int64}"><code>Base.copyto!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copyto!(u::ScalarData,v::AbstractVector,cache::BasicILMCache,i::Int)</code></pre><p>Copy the data in <code>v</code> to the elements in <code>u</code> associated with body <code>i</code> in the body list in <code>cache</code>. <code>v</code> must have the same length as this subarray of <code>u</code> associated with <code>i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L929-L934">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.Laplacian-Tuple{BasicILMCache, Any}" href="#CartesianGrids.Laplacian-Tuple{BasicILMCache, Any}"><code>CartesianGrids.Laplacian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Laplacian(cache::BasicILMCache,coeff_factor::Real[,with_inverse=true])</code></pre><p>Create an invertible Laplacian operator for the grid in <code>cache</code>, using the index or grid scaling associated with <code>cache</code>. The operator is pre-multiplied by the factor <code>coeff_factor</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L373-L379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.RegularizationMatrix-Tuple{BasicILMCache, PointData, GridData}" href="#CartesianGrids.RegularizationMatrix-Tuple{BasicILMCache, PointData, GridData}"><code>CartesianGrids.RegularizationMatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RegularizationMatrix(cache::BasicILMCache,src::PointData,trg::GridData)</code></pre><p>Create a regularization matrix for regularizing point data of type <code>src</code> to grid data of type <code>trg</code>. (Both <code>src</code> and <code>trg</code> must be appropriately sized for the grid and points in <code>cache</code>.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L352-L358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CartesianGrids.InterpolationMatrix-Tuple{BasicILMCache, GridData, PointData}" href="#CartesianGrids.InterpolationMatrix-Tuple{BasicILMCache, GridData, PointData}"><code>CartesianGrids.InterpolationMatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">InterpolationMatrix(cache::BasicILMCache,src::GridData,trg::PointData)</code></pre><p>Create a interpolation matrix for regularizing grid data of type <code>src</code> to point data of type <code>trg</code>. (Both <code>src</code> and <code>trg</code> must be appropriately sized for the grid and points in <code>cache</code>.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/cache.jl#L363-L369">source</a></section></article><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Yang, X., et al., (2009) &quot;A smoothing technique for discrete delta functions with application to immersed boundary method in moving boundary simulations,&quot; J. Comput. Phys., 228, 7821–7836.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../surfaceops/">Surface-grid operations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 10 November 2023 23:01">Friday 10 November 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

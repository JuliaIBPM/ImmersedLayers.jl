<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Helmholtz decomposition · ImmersedLayers.jl</title><meta name="title" content="Helmholtz decomposition · ImmersedLayers.jl"/><meta property="og:title" content="Helmholtz decomposition · ImmersedLayers.jl"/><meta property="twitter:title" content="Helmholtz decomposition · ImmersedLayers.jl"/><meta name="description" content="Documentation for ImmersedLayers.jl."/><meta property="og:description" content="Documentation for ImmersedLayers.jl."/><meta property="twitter:description" content="Documentation for ImmersedLayers.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ImmersedLayers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../caches/">Immersed layer caches</a></li><li><a class="tocitem" href="../surfaceops/">Surface-grid operations</a></li><li><a class="tocitem" href="../multbodies/">Multiple bodies</a></li><li><a class="tocitem" href="../gridops/">Grid operations</a></li><li class="is-active"><a class="tocitem" href>Helmholtz decomposition</a><ul class="internal"><li><a class="tocitem" href="#Helmholtz-decomposition-functions"><span>Helmholtz decomposition functions</span></a></li></ul></li><li><a class="tocitem" href="../matrices/">Matrix operators</a></li><li><a class="tocitem" href="../dirichlet/">A Dirichlet Poisson problem</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li></ul></li><li><span class="tocitem">Setting up PDEs</span><ul><li><a class="tocitem" href="../problems/">Problems and the system</a></li><li><a class="tocitem" href="../neumann/">Poisson with Neumann conditions</a></li><li><a class="tocitem" href="../stokes/">Stokes flow</a></li><li><a class="tocitem" href="../heatconduction/">Setting up a time-varying PDE</a></li><li><a class="tocitem" href="../heatconduction-unbounded/">A time-varying PDE with forcing</a></li><li><a class="tocitem" href="../heatconduction-neumann/">A time-varying PDE with Neumann conditions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Helmholtz decomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Helmholtz decomposition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ImmersedLayers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/main/test/literate/helmholtz.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Helmholtz-decomposition"><a class="docs-heading-anchor" href="#Helmholtz-decomposition">Helmholtz decomposition</a><a id="Helmholtz-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Helmholtz-decomposition" title="Permalink"></a></h1><p>For vector fields on the grid, we often prefer to work with potentials of that field and compose the vector field from these potentials. This is the so-called Helmholtz decomposition</p><p class="math-container">\[\mathbf{v} = \nabla\phi + \nabla\times\psi\]</p><p>where <span>$\psi$</span> is a vector potential (or streamfunction in two dimensions) and <span>$\phi$</span> is a scalar potential. Note that, in an unbounded domain, <span>$\phi$</span> satisfies a Poisson equation:</p><p class="math-container">\[\nabla^2\phi = \nabla\cdot\mathbf{v}\]</p><p>and, assuming that <span>$\psi$</span> has zero &#39;gauge&#39; (i.e., its divergence is zero), then <span>$\psi$</span> also satisfies a Poisson equation:</p><p class="math-container">\[\nabla^2\psi = -\nabla\times\mathbf{v}\]</p><p>So we can recover the velocity field from the divergence and curl of the vector field (in fluid dynamics, these are the rate of dilatation and the vorticity, respectively) by solving these equations for the potentials and then evaluating their gradient and curl.</p><p>With immersed layers, these are extendable to domains with surfaces and their associated jump in the vector field <span>$[\mathbf{v}] = \mathbf{v}^+ - \mathbf{v}^-$</span>. The crucial relationships are</p><p class="math-container">\[\nabla\cdot{\overline{\mathbf{v}}} = \overline{\nabla\cdot\mathbf{v}} + \delta(\chi)\mathbf{n}\cdot[\mathbf{v}]\]</p><p>and</p><p class="math-container">\[\nabla\times{\overline{\mathbf{v}}} = \overline{\nabla\times\mathbf{v}} + \delta(\chi)\mathbf{n}\times[\mathbf{v}]\]</p><p>These are, respectively, the divergence and curl of the masked vector field, <span>$\overline{\mathbf{v}}$</span>. In <code>ImmersedLayers.jl</code>, we are always working with the masked form of a field, whether we acknowledge it or not. In contrast, the first terms on the right-hand sides of these are the masked divergence and curl of the vector field in each side of the surface. The difference between these is a type of single-layer surface term–-a &#39;source sheet&#39; or a &#39;vortex sheet&#39;, respectively–- due to the jump in vector field. If we omit the overbar notation, then the Helmholtz decomposition and the Poisson equations all still hold.</p><p>This package has a number of routines that can be used to perform the operations described here. They rely on two caches, <a href="#ImmersedLayers.ScalarPotentialCache"><code>ScalarPotentialCache</code></a> and <a href="#ImmersedLayers.VectorPotentialCache"><code>VectorPotentialCache</code></a>, each of which supports one of the respective potentials. The function <a href="#ImmersedLayers.vecfield_helmholtz!"><code>vecfield_helmholtz!</code></a> carries out all of these operations in order to assemble the vector field <span>$\mathbf{v}$</span> from the masked divergence and curl fields and the jump in the vector field. (We can also add an additional irrotational, divergence-free vector field during this assembly.</p><h2 id="Helmholtz-decomposition-functions"><a class="docs-heading-anchor" href="#Helmholtz-decomposition-functions">Helmholtz decomposition functions</a><a id="Helmholtz-decomposition-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helmholtz-decomposition-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.ScalarPotentialCache" href="#ImmersedLayers.ScalarPotentialCache"><code>ImmersedLayers.ScalarPotentialCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ScalarPotentialCache(base_cache::BasicILMCache)</code></pre><p>Create a cache for calculations involving the scalar potential field that induces a vector field on the grid. The base cache must be in support of vector field data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.VectorPotentialCache" href="#ImmersedLayers.VectorPotentialCache"><code>ImmersedLayers.VectorPotentialCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">VectorPotentialCache(base_cache::BasicILMCache)</code></pre><p>Create a cache for calculations involving the vector potential field (i.e. streamfunction) that induces a vector field on the grid. The base cache must be in support of vector field data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L42-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.VectorFieldCache" href="#ImmersedLayers.VectorFieldCache"><code>ImmersedLayers.VectorFieldCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">VectorFieldCache(base_cache::BasicILMCache)</code></pre><p>Create a cache for calculations involving the vector field derived from the vector and scalar potentials. The base cache must be in support of vector field data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L57-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vectorpotential_from_masked_curlv!" href="#ImmersedLayers.vectorpotential_from_masked_curlv!"><code>ImmersedLayers.vectorpotential_from_masked_curlv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vectorpotential_from_masked_curlv!(ψ::Nodes{Dual},masked_curlv::Nodes{Dual},dv::VectorData,base_cache::BasicILMCache,wcache::VectorPotentialCache)</code></pre><p>Return the vector potential field <code>ψ</code> from the masked curl of the vector field, <code>masked_curlv</code> (<span>$\overline{\nabla\times\mathbf{v}}$</span>), the jump in the vector field across immersed surface <code>dv</code>. It solves</p><p><span>$L_n\psi = -\overline{\nabla\times\mathbf{v}} - R_n\mathbf{n}\times[\mathbf{v}]$</span></p><p>and returns <span>$\psi$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L75-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.scalarpotential_from_masked_divv!" href="#ImmersedLayers.scalarpotential_from_masked_divv!"><code>ImmersedLayers.scalarpotential_from_masked_divv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">scalarpotential_from_masked_divv!(ϕ::Nodes{Primal},masked_divv::Nodes{Primal},dv::VectorData,base_cache::BasicILMCache,dcache::ScalarPotentialCache)</code></pre><p>Return the scalar potential field <code>ϕ</code> from the masked divergence of the vector field, <code>masked_divv</code> (<span>$\overline{\nabla\cdot\mathbf{v}}$</span>) the jump in the vector field across immersed surface <code>dv</code>. It solves</p><p><span>$L_c\phi = \overline{\nabla\cdot\mathbf{v}} + R_c\mathbf{n}\cdot[\mathbf{v}]$</span></p><p>and returns <span>$\phi$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L186-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vectorpotential_from_curlv!" href="#ImmersedLayers.vectorpotential_from_curlv!"><code>ImmersedLayers.vectorpotential_from_curlv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vectorpotential_from_curlv!(ψ::Nodes{Dual},curlv::Nodes{Dual},base_cache::BasicILMCache)</code></pre><p>Return the vector potential field <code>ψ</code> from the curl of the masked vector field, <code>curlv</code> (<span>$\nabla\times\overline{\mathbf{v}}$</span>), the jump in the vector field across immersed surface <code>dv</code>. It solves</p><p><span>$L_n\psi = -\nabla\times\overline{\mathbf{v}}$</span></p><p>and returns <span>$\psi$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L107-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vecfield_from_vectorpotential!" href="#ImmersedLayers.vecfield_from_vectorpotential!"><code>ImmersedLayers.vecfield_from_vectorpotential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vecfield_from_vectorpotential!(v::Edges{Primal},ψ::Nodes{Dual},base_cache::BasicILMCache)</code></pre><p>Return the vector field <code>v</code> associated with vector potential field <code>ψ</code> (in 2-d, a scalar streamfunction), via the curl</p><p><span>$\mathbf{v} = \nabla\times\psi \mathbf{e}_z$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L122-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.masked_curlv_from_curlv_masked!" href="#ImmersedLayers.masked_curlv_from_curlv_masked!"><code>ImmersedLayers.masked_curlv_from_curlv_masked!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">masked_curlv_from_curlv_masked!(masked_curlv::Nodes{Dual},curlv::Nodes{Dual},dv::VectorData,base_cache::BasicILMCache,wcache::VectorPotentialCache)</code></pre><p>Return the masked curl of the vector field <span>$\overline{\nabla\times\mathbf{v}}$</span> (<code>masked_curlv</code>) from the curl of the masked vector field <span>$\nabla\times\overline{\mathbf{v}}$</span> (<code>curlv</code>). It obtains this from</p><p><span>$\overline{\nabla\times\mathbf{v}} = \nabla\times\overline{\mathbf{v}} - R_n\mathbf{n}\times[\mathbf{v}]$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L136-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.curlv_masked_from_masked_curlv!" href="#ImmersedLayers.curlv_masked_from_masked_curlv!"><code>ImmersedLayers.curlv_masked_from_masked_curlv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">curlv_masked_from_masked_curlv!(curlv::Nodes{Dual},masked_curlv::Nodes{Dual},dv::VectorData,base_cache::BasicILMCache,wcache::VectorPotentialCache)</code></pre><p>Return the curl of the masked vector field <span>$\nabla\times\overline{\mathbf{v}}$</span> (<code>curlv</code>) from the masked curl of the vector field <span>$\overline{\nabla\times\mathbf{v}}$</span> (<code>masked_curlv</code>). It obtains this from</p><p><span>$\nabla\times\overline{\mathbf{v}} = \overline{\nabla\times\mathbf{v}} + R_n\mathbf{n}\times[\mathbf{v}]$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L161-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.scalarpotential_from_divv!" href="#ImmersedLayers.scalarpotential_from_divv!"><code>ImmersedLayers.scalarpotential_from_divv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">scalarpotential_from_divv!(ϕ::Nodes{Primal},divv::Nodes{Primal},base_cache::BasicILMCache,dcache::ScalarPotentialCache)</code></pre><p>Return the scalar potential field <code>ϕ</code> from the divergence of the masked vector field, <code>divv</code> (<span>$\nabla\cdot\overline{\mathbf{v}}$</span>) the jump in the vector field across immersed surface <code>dv</code>. It solves</p><p><span>$L_c\phi = \nabla\cdot\overline{\mathbf{v}}$</span></p><p>and returns <span>$\phi$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L217-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.masked_divv_from_divv_masked!" href="#ImmersedLayers.masked_divv_from_divv_masked!"><code>ImmersedLayers.masked_divv_from_divv_masked!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">masked_divv_from_divv_masked!(masked_divv::Nodes{Primal},divv::Nodes{Primal},dv::VectorData,base_cache::BasicILMCache,dcache::ScalarPotentialCache)</code></pre><p>Return the masked divergence of the vector field <span>$\overline{\nabla\cdot\mathbf{v}}$</span> (<code>masked_divv</code>) from the divergence of the masked vector field <span>$\nabla\cdot\overline{\mathbf{v}}$</span> (<code>divv</code>). It obtains this from</p><p><span>$\overline{\nabla\cdot\mathbf{v}} = \nabla\cdot\overline{\mathbf{v}} - R_c\mathbf{n}\cdot[\mathbf{v}]$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L247-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.divv_masked_from_masked_divv!" href="#ImmersedLayers.divv_masked_from_masked_divv!"><code>ImmersedLayers.divv_masked_from_masked_divv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divv_masked_from_masked_divv!(divv::Nodes{Primal},masked_divv::Nodes{Primal},dv::VectorData,base_cache::BasicILMCache,dcache::ScalarPotentialCache)</code></pre><p>Return the divergence of the masked vector field <span>$\nabla\cdot\overline{\mathbf{v}}$</span> (<code>divv</code>) from the masked divergence of the vector field <span>$\overline{\nabla\cdot\mathbf{v}}$</span> (<code>masked_divv</code>). It obtains this from</p><p><span>$\nabla\cdot\overline{\mathbf{v}} = \overline{\nabla\cdot\mathbf{v}} + R_c\mathbf{n}\cdot[\mathbf{v}]$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L273-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vecfield_from_scalarpotential!" href="#ImmersedLayers.vecfield_from_scalarpotential!"><code>ImmersedLayers.vecfield_from_scalarpotential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vecfield_from_scalarpotential!(v::Edges{Primal},ϕ::Nodes{Primal},base_cache::BasicILMCache)</code></pre><p>Return the vector field <code>v</code> associated with scalar potential field <code>ϕ</code>, via the gradient</p><p><span>$\mathbf{v} = \nabla\phi$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L234-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vecfield_helmholtz!" href="#ImmersedLayers.vecfield_helmholtz!"><code>ImmersedLayers.vecfield_helmholtz!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vecfield_helmholtz!(v::Edges{Primal},curlv::Nodes{Dual},divv::Nodes{Primal},dv::VectorData,vp::Union{Edges{Primal},Nothing},base_cache::BasicILMCache,veccache::VectorFieldCache)</code></pre><p>Recover the vector field <code>v</code> from the masked curl field <code>curlv</code> (<span>$\overline{\nabla\times\mathbf{v}}$</span>), divergence field <code>divv</code> (<span>$\overline{\nabla\cdot\mathbf{v}}$</span>), surface vector jump <code>dv</code> (<span>$[\mathbf{v}]$</span>), and additional irrotational, divergence-free vector field <code>vp</code>. It obtains this from the Helmholtz decomposition,</p><p><span>$\mathbf{v} = \nabla\times\psi + \nabla\phi + \mathbf{v}_p$</span></p><p>in which <span>$\psi$</span> is the solution of</p><p><span>$L_n\overline{\psi} = -\overline{\nabla\times\mathbf{v}} - R_n\mathbf{n}\times[\mathbf{v}]$</span></p><p>in which <span>$\phi$</span> is the solution of</p><p><span>$L_c\overline{\phi} = \overline{\nabla\cdot\mathbf{v}} + R_c\mathbf{n}\cdot[\mathbf{v}]$</span></p><p>It is important to stress that <code>curlv</code> is the masked curl of the vector field, not the curl of the masked vector field. To get this the former from the latter, use <a href="#ImmersedLayers.masked_curlv_from_curlv_masked!"><code>masked_curlv_from_curlv_masked!</code></a>. Similarly for <code>divv</code>, which is the masked divergence of the vector field, not the divergence of the masked vector field. One can use <a href="#ImmersedLayers.masked_divv_from_divv_masked!"><code>masked_divv_from_divv_masked!</code></a> for this.</p><p>To specify the irrotational, divergence-free vector field <code>vp</code>, one can also simply provide a tuple, e.g., <code>(1.0,0.0)</code>, to specify a uniform vector field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L301-L326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vectorpotential_uniformvecfield!" href="#ImmersedLayers.vectorpotential_uniformvecfield!"><code>ImmersedLayers.vectorpotential_uniformvecfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vectorpotential_uniformvecfield!(ψ::Nodes{Dual},Vx::Real,Vy::Real,base_cache::BasicILMCache)</code></pre><p>Return a vector potential field <code>ψ</code> associated with a uniform vector field with the components <code>Vx</code> and <code>Vy</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L349-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.scalarpotential_uniformvecfield!" href="#ImmersedLayers.scalarpotential_uniformvecfield!"><code>ImmersedLayers.scalarpotential_uniformvecfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">scalarpotential_uniformvecfield!(ϕ::Nodes{Primal},Vx::Real,Vy::Real,base_cache::BasicILMCache)</code></pre><p>Return a vector potential field <code>ϕ</code> associated with a uniform vector field with the components <code>Vx</code> and <code>Vy</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L363-L367">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ImmersedLayers.vecfield_uniformvecfield!" href="#ImmersedLayers.vecfield_uniformvecfield!"><code>ImmersedLayers.vecfield_uniformvecfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vecfield_uniformvecfield!(v::Edges{Primal},Vx::Real,Vy::Real,base_cache::BasicILMCache)</code></pre><p>Return a vector field <code>v</code> filled with the uniform components <code>Vx</code> and <code>Vy</code>, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIBPM/ImmersedLayers.jl/blob/01f3e9132ed313580fd7cb86775dccf69db475ee/src/helmholtz.jl#L377-L381">source</a></section></article><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gridops/">« Grid operations</a><a class="docs-footer-nextpage" href="../matrices/">Matrix operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 10 November 2023 23:01">Friday 10 November 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
